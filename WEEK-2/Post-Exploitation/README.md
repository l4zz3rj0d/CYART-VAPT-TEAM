# Post-Exploitation – Metasploitable2

## Objective
To assess the impact of the initial compromise by performing controlled
post-exploitation activities, including privilege escalation, sensitive data
access, and evidence collection, while maintaining a non-destructive approach.

---

## Initial Access Context
Following successful exploitation of the Apache Tomcat Manager service, an
initial **low-privileged shell** was obtained on the target system. Post-
exploitation activities were conducted to evaluate privilege boundaries and
identify potential misconfigurations.

---

## Privilege Escalation Analysis
System enumeration was performed to identify binaries with elevated execution
permissions. Using file permission analysis, a misconfigured **SUID binary**
was discovered.

The following command was used to identify SUID-enabled binaries:
```
find / -perm -4000 2>>/dev/null
```

- Enumeration of files with the SUID bit set revealed that **`nmap`** was owned
  by the root user and configured with SUID permissions.

This configuration allows the binary to execute with root-level privileges,
representing a critical security misconfiguration.

---

## Privilege Escalation
The identified SUID-enabled `nmap` binary was leveraged to escalate privileges.
By invoking `nmap` in interactive mode, a **root shell** was successfully
spawned.
```
tomcat55@metasploitable:/$ /usr/bin/nmap --interactive
Starting Nmap V. 4.53 ( http://insecure.org )
Welcome to Interactive Mode -- press h <enter> for help
nmap> !sh
whoami
root
```

Privilege escalation was verified using identity and user context validation
commands, confirming full administrative access to the system.

---

## Impact Validation
With root privileges obtained, access to sensitive system files was possible.
As part of impact validation, the system’s credential storage file was accessed:

- `/etc/shadow`

Access to this file confirms complete system compromise and exposure of user
credential hashes.

---

## Credential Exposure and Evidence Analysis

During post-exploitation, access to sensitive system files was successfully
validated. The `/etc/shadow` file was retrieved, confirming exposure of system
credential data. The extracted root password hash demonstrates complete system
compromise and improper protection of authentication material.

The identified hash format is suitable for offline password cracking using
tools such as **John the Ripper**, enabling attackers to perform brute-force or
dictionary attacks without further interaction with the target system. Even
without successful cracking, exposure of password hashes represents a critical
security risk.

| Item        | Description               | Extracted Hash                                      |
|-------------|---------------------------|----------------------------------------------------|
| /etc/shadow | System credential storage | `root:$1$/avpfBJ1$x0z8w5UF9Iv./DR9E9Lid.:14747:0:99999:7:::` |


---

## Result
Post-exploitation activities successfully demonstrated:
- Privilege escalation from a low-privileged user to root
- Exposure of sensitive credential storage
- Full system compromise due to insecure file permissions and misconfigurations

---

## Security Impact
This phase highlights the risks associated with:
- Improper SUID binary configuration
- Insecure privilege boundaries
- Exposure of credential material

An attacker exploiting these weaknesses could gain full administrative control
of the system without exploiting kernel-level vulnerabilities.
